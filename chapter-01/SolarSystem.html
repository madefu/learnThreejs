<head>
    <title>Example 01.04 - Materials, light and animation</title>

    <script type="text/javascript" src="../libs/three.js"></script>
	<script src="../libs/DDSLoader.js"></script>
	<script src="../libs/OBJLoader.js"></script>
	<script type="text/javascript" src="../libs/OrbitControls.js"></script>
    <script type="text/javascript" src="../libs/stats.js"></script>

    <style>
        body {
            /* set margin to 0 and overflow to hidden, to go fullscreen */
            margin: 0;
            overflow: hidden;
        }
    </style>
</head>
<body>

<div id="Stats-output">
</div>
<!-- Div which will hold the Output -->
<div id="WebGL-output">
	
<!-- Javascript code that runs our Three.js examples -->
<script type="text/javascript">
//一个空间
// create a scene, that will hold all our elements such as objects, cameras and lights.
var scene = new THREE.Scene();//the space
//尺寸缩放比例，角速度缩放比例，
let angularRate=0.02;
//万公里太大，导致半径会被忽略，所以半径和距离单位统一为千公里
let rangeRate=10;
var camera = initCamera();
//一个相机
//Y轴垂直向下看到0点
function initCamera(){
	camera = new THREE.PerspectiveCamera(90, window.innerWidth / window.innerHeight, 0.1, 63100);
	// camera = new THREE.OrthographicCamera(30000,-30000,0,30000,50000);
	// position and point the camera to the center of the scene
	camera.position.x = 500;
	camera.position.y = 500;
	camera.position.z = 142940;
	camera.lookAt(new THREE.Vector3(0,0,142940));
	return camera;
}

//星球对象构造函数，半径，相对角速度,相对参照位置(渲染时候做)
function createPlanet(radius,angularSpeed,img,x,y,z,flag){
	//半径
	var planet = new Object;
	planet.radius = radius*rangeRate;
	planet.angularSpeed = angularSpeed * angularRate;
	planet.sphere=new THREE.SphereGeometry(radius,40,40);
	// mercury.sphere.position.x=1000;
	//材质
	var texture = THREE.ImageUtils.loadTexture(img);//new THREE.TextureLoader().load(img);
	var material = new THREE.MeshBasicMaterial( { map: texture } );
	planet.sphere = new THREE.Mesh(planet.sphere , material);
	// var cube_metal = new THREE.Mesh(planet.sphere,material);
	planet.sphere.position.x=x;
	planet.sphere.position.y=y;
	planet.sphere.position.z=z;
	scene.add(planet.sphere);
	// scene.add(planet.sphere);
	
	if(flag==true){
		//需要增加土星环
		//立体原型环----放弃、不知道如何设置切面圆内径
		// var geometry = new THREE.TorusGeometry( radius+(), , 16, 100 );
		// 平面圆环
		var geometry = new THREE.RingGeometry( planet.radius+66.9, planet.radius+483, 32 );
		var material = new THREE.MeshBasicMaterial( { color: 0xffff00 } );
		planet.hasTorus = true;
		planet.torus = new THREE.Mesh( geometry, material );
		planet.torus.position.x = x;
		planet.torus.position.y = y;
		planet.torus.position.z = z;
		scene.add( planet.torus );
	}else{
		planet.hasTorus = false;
	}
	
	return planet;
}

//一个太阳
let sun=createPlanet(140,0,'../assets/textures/planets/sun2.jpg',0,0,0);
let mercury =createPlanet(0.48,0,'../assets/textures/planets/mercury.jpg',0,0,5791);
let venus = createPlanet(1.21,0,'../assets/textures/planets/venus.jpg',0,0,10820);
let earth = createPlanet(1.27,0,'../assets/textures/planets/Earth.png',0,0,14960);
let mars = createPlanet(0.67,0,'../assets/textures/planets/Mars.png',0,0,22800);
let jupiter = createPlanet(14.3,0,'../assets/textures/planets/Jupiter.jpg',0,0,77830);
let saturn = createPlanet(12.05,0,'../assets/textures/planets/Saturn.jpg',0,0,142940,true);


//(1000,0,1000);
let flag=1;
function renderScene(){
	// create a render and set the size
 	/* if(camera.position.z>75000){
		flag=-1;
		
	}
	if(camera.position.z<0){
		flag=1;
	}
	camera.position.z+=50*flag; */
	// render using requestAnimationFrame
	requestAnimationFrame(renderScene);
	renderer.render(scene, camera);
}

var spotLightNeptune = initSpotLight(spotLightNeptune);
		function initSpotLight(spotLight){
			// add spotlight for the shadows
			spotLight = new THREE.SpotLight(0xffffff,0.5);
			spotLight.position.set(-100, 10000, -100);
			spotLight.castShadow = false;
			scene.add(spotLight);
			return spotLight;
		}
var renderer = new THREE.WebGLRenderer();
renderer.setClearColor(new THREE.Color(0x000000, 1.0));
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.shadowMapEnabled = true;
renderScene();
// add the output of the renderer to the html element
document.getElementById("WebGL-output").appendChild(renderer.domElement);
	
</script>
</div>
</body>
</html>
